{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '48291953-85546cde0c7bc9cda0531770b';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 15;\n\nlet currentPage = 1;\n\nexport async function fetchImages(query, page = 1) {\n  try {\n    const url = `${BASE_URL}?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&per_page=${PER_PAGE}&page=${page}`;\n    const response = await axios.get(url);\n\n    if (response.data.hits.length === 0) {\n      throw new Error('No images found');\n    }\n\n    currentPage = page;\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n}\n\nexport function resetPage() {\n  currentPage = 1;\n}\n\nexport function getCurrentPage() {\n  return currentPage;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport function clearGallery() {\n  const gallery = document.querySelector('.gallery');\n  gallery.innerHTML = '';\n}\n\nexport function showImages(images) {\n  const gallery = document.querySelector('.gallery');\n\n  const markup = images\n    .map(\n      image => `\n      <a href=\"${image.largeImageURL}\" class=\"gallery-item\">\n        <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" class=\"gallery-image\" />\n        <div class=\"image-info\">\n          <p>Likes: <span>${image.likes}</span></p>\n          <p>Views: <span>${image.views}</span></p>\n          <p>Comments: <span>${image.comments}</span></p>\n          <p>Downloads: <span>${image.downloads}</span></p>\n        </div>\n      </a>\n    `\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nexport function showErrorMessage() {\n  iziToast.error({\n    title: 'Error',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n  });\n}\n\nexport function showLoadingIndicator() {\n  const loading = document.querySelector('.loading');\n  loading.style.display = 'block';\n  const loadMoreButton = document.querySelector('.load-more');\n  loadMoreButton.style.marginBottom = '20px';\n}\n\nexport function hideLoadingIndicator() {\n  const loading = document.querySelector('.loading');\n  loading.style.display = 'none';\n}\n\nexport function toggleLoadMoreButton(visible) {\n  const loadMoreButton = document.querySelector('.load-more');\n  loadMoreButton.style.display = visible ? 'block' : 'none';\n}\n\nexport function showEndOfResultsMessage() {\n  iziToast.info({\n    title: 'Info',\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n}\n","import { fetchImages, resetPage, getCurrentPage } from './js/pixabay-api.js';\nimport {\n  clearGallery,\n  showImages,\n  showErrorMessage,\n  showLoadingIndicator,\n  hideLoadingIndicator,\n  toggleLoadMoreButton,\n  showEndOfResultsMessage,\n} from './js/render-functions.js';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\ntoggleLoadMoreButton(false);\n\nlet query = '';\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n  showCounter: false,\n});\n\ndocument\n  .querySelector('.search-form')\n  .addEventListener('submit', async function (event) {\n    event.preventDefault();\n    query = document.querySelector('.search-input').value.trim();\n\n    if (!query) {\n      toggleLoadMoreButton(false);\n      clearGallery();\n      showErrorMessage();\n      return;\n    }\n\n    resetPage();\n    clearGallery();\n    toggleLoadMoreButton(false);\n    showLoadingIndicator();\n\n    try {\n      const data = await fetchImages(query, 1);\n      hideLoadingIndicator();\n\n      if (data.hits.length === 0) {\n        toggleLoadMoreButton(false);\n        showErrorMessage();\n        return;\n      }\n\n      showImages(data.hits);\n      lightbox.refresh();\n\n      toggleLoadMoreButton(data.totalHits > data.hits.length);\n    } catch (error) {\n      hideLoadingIndicator();\n      toggleLoadMoreButton(false);\n      showErrorMessage();\n      console.error(error);\n    }\n  });\n\ndocument\n  .querySelector('.load-more')\n  .addEventListener('click', async function () {\n    const nextPage = getCurrentPage() + 1;\n\n    showLoadingIndicator();\n    try {\n      const data = await fetchImages(query, nextPage);\n      hideLoadingIndicator();\n\n      if (data.hits.length === 0) {\n        toggleLoadMoreButton(false);\n        return;\n      }\n\n      showImages(data.hits);\n      lightbox.refresh();\n\n      const totalLoaded = nextPage * 15;\n      if (totalLoaded >= data.totalHits) {\n        toggleLoadMoreButton(false);\n        showEndOfResultsMessage();\n      } else {\n        toggleLoadMoreButton(true);\n      }\n\n      const { height: cardHeight } = document\n        .querySelector('.gallery')\n        .firstElementChild.getBoundingClientRect();\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    } catch (error) {\n      hideLoadingIndicator();\n      toggleLoadMoreButton(false);\n      showErrorMessage();\n      console.error(error);\n    }\n  });\n"],"names":["API_KEY","BASE_URL","PER_PAGE","currentPage","fetchImages","query","page","url","response","axios","error","resetPage","getCurrentPage","clearGallery","gallery","showImages","images","markup","image","showErrorMessage","iziToast","showLoadingIndicator","loading","loadMoreButton","hideLoadingIndicator","toggleLoadMoreButton","visible","showEndOfResultsMessage","lightbox","SimpleLightbox","event","data","nextPage","cardHeight"],"mappings":"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"}